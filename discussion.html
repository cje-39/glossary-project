<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Term Discussion - East translation team</title>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="discussion.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Term Discussion</h1>
            <div style="text-align: center; margin-top: 15px;">
                <a href="hub.html" class="btn btn-primary" style="text-decoration: none; display: inline-block; padding: 8px 16px; font-size: 13px;">ğŸ  Main page</a>
            </div>
        </header>

        <!-- AI API í‚¤ ì„¤ì • -->
        <div id="apiKeySection" style="display: none; margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e0e0e0;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 13px;">
                Claude API í‚¤ (ì˜ë¯¸(AI) ê¸°ëŠ¥ ì‚¬ìš©ìš©)
            </label>
            <div style="display: flex; gap: 10px; align-items: center;">
                <input type="password" id="claudeApiKeyInput" placeholder="sk-ant-..." style="flex: 1; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;" value="">
                <button id="saveApiKeyBtn" class="btn btn-secondary" style="padding: 8px 16px; font-size: 13px;">ì €ì¥</button>
                <button id="clearApiKeyBtn" class="btn btn-secondary" style="padding: 8px 16px; font-size: 13px;">ì‚­ì œ</button>
            </div>
            <div id="apiKeyStatus" style="font-size: 12px; margin-top: 8px; padding: 8px; background: #fff; border-radius: 4px; border: 1px solid #e0e0e0;">
                âš ï¸ API í‚¤ ìƒíƒœ í™•ì¸ ì¤‘...
            </div>
            <small style="color: #999; font-size: 11px; display: block; margin-top: 5px;">
                API í‚¤ê°€ ì—†ìœ¼ë©´ ì˜ë¯¸(AI) ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. Anthropic Console(https://console.anthropic.com)ì—ì„œ API í‚¤ë¥¼ ë°œê¸‰ë°›ìœ¼ì„¸ìš”.
            </small>
        </div>

        <div id="postsContainer" class="posts-container">
            <!-- ê²Œì‹œë¬¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
        </div>
    </div>

    <!-- ìƒˆ ê²Œì‹œë¬¼ ì‘ì„± ëª¨ë‹¬ -->
    <div id="postModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">í† ë¡  ë“±ë¡í•˜ê¸°</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form id="postForm">
                    <div class="form-group">
                        <label for="postAuthor">ì‘ì„±ì *</label>
                        <div style="position: relative;">
                            <div id="authorDropdown" class="author-dropdown" style="position: relative;">
                                <div id="authorDropdownToggle" class="author-dropdown-toggle" style="width: 100%; padding: 10px 12px; border: 2px solid #e0e0e0; border-radius: 8px; background: #ffffff; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-size: 14px;">
                                    <span id="authorSelectedValue" style="color: #999;">ì„ íƒí•˜ì„¸ìš”</span>
                                    <span style="color: #999;">â–¼</span>
                                </div>
                                <input type="hidden" id="postAuthor" required>
                                <div id="authorDropdownMenu" class="author-dropdown-menu" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 2px solid #e0e0e0; border-radius: 8px; margin-top: 4px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); z-index: 1000; max-height: 300px; overflow-y: auto;">
                                    <div id="authorListItems" style="display: flex; flex-direction: column;">
                                        <!-- ì‘ì„±ì ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                                    </div>
                                    <div style="border-top: 1px solid #e0e0e0; padding: 8px;">
                                        <div id="newAuthorInput" style="display: none;">
                                            <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                                <input type="text" id="newAuthorName" placeholder="ì‘ì„±ì ì´ë¦„ ì…ë ¥" style="flex: 1; padding: 6px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                            </div>
                                            <div style="display: flex; gap: 8px;">
                                                <button type="button" id="saveAuthorBtn" class="btn btn-primary" style="flex: 1; padding: 6px; font-size: 13px;">ì €ì¥</button>
                                                <button type="button" id="cancelAuthorBtn" class="btn btn-secondary" style="flex: 1; padding: 6px; font-size: 13px;">ì·¨ì†Œ</button>
                                            </div>
                                        </div>
                                        <button type="button" id="addAuthorBtn" class="btn btn-secondary" style="width: 100%; padding: 8px; font-size: 13px;">+ ì‘ì„±ì ì¶”ê°€</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="postCategory">ì¹´í…Œê³ ë¦¬</label>
                        <input type="text" id="postCategory" placeholder="ì¹´í…Œê³ ë¦¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label for="postDirection">ì–¸ì–´ ë°©í–¥ *</label>
                        <select id="postDirection" required>
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="í•œì¼">í•œì¼</option>
                            <option value="ì¼í•œ">ì¼í•œ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="postKR">KR</label>
                        <input type="text" id="postKR" placeholder="í•œêµ­ì–´ ë‹¨ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label for="postJP">JP</label>
                        <input type="text" id="postJP" placeholder="ì¼ë³¸ì–´ ë‹¨ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label for="postContent">ì˜ê²¬ *</label>
                        <textarea id="postContent" rows="6" required placeholder="ì˜ê²¬ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="postNote">ë¹„ê³ /ì˜ˆì‹œë¬¸</label>
                        <textarea id="postNote" rows="4" placeholder="ë¹„ê³ ë‚˜ ì˜ˆì‹œë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">ê²Œì‹œ</button>
                        <button type="button" class="btn btn-secondary" id="cancelPostBtn">ì·¨ì†Œ</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Firebase SDK v8 (CDN í˜¸í™˜) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="firebase-init.js"></script>
    <script src="netlify-config.js"></script>
    <script>
        // Firebase SDK ë¡œë“œ í›„ discussion.js ì‹¤í–‰
        (async function() {
            // firebase-init.jsê°€ ë¡œë“œë  ë•Œê¹Œì§€ ëŒ€ê¸°
            let attempts = 0;
            while (typeof waitForFirebaseSDK === 'undefined' && attempts < 50) {
                await new Promise(resolve => setTimeout(resolve, 100));
                attempts++;
            }
            
            try {
                // Firebase SDK ë¡œë“œ ëŒ€ê¸°
                if (typeof waitForFirebaseSDK === 'function') {
                    await waitForFirebaseSDK();
                }
            } catch (error) {
                console.error('Firebase SDK ë¡œë“œ ì‹¤íŒ¨:', error);
            }
            
            // discussion.js ë¡œë“œ
            const script = document.createElement('script');
            script.src = 'discussion.js';
            document.body.appendChild(script);
        })();
    </script>
</body>
</html>
